import { useEffect, useRef } from 'react';
import gsap from 'gsap';
import { ScrollTrigger } from 'gsap/ScrollTrigger';
import { Marquee } from '../../ui/Marquee';
import styles from './LogoMarquee.module.scss';

gsap.registerPlugin(ScrollTrigger);

// Logo components - clean, minimal SVGs
const Logos = {
  figma: () => (
    <svg className={styles.logo} viewBox="0 0 38 57" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M19 28.5C19 23.2533 23.2533 19 28.5 19C33.7467 19 38 23.2533 38 28.5C38 33.7467 33.7467 38 28.5 38C23.2533 38 19 33.7467 19 28.5Z" fill="currentColor"/>
      <path d="M0 47.5C0 42.2533 4.25329 38 9.5 38H19V47.5C19 52.7467 14.7467 57 9.5 57C4.25329 57 0 52.7467 0 47.5Z" fill="currentColor"/>
      <path d="M19 0V19H28.5C33.7467 19 38 14.7467 38 9.5C38 4.25329 33.7467 0 28.5 0H19Z" fill="currentColor"/>
      <path d="M0 9.5C0 14.7467 4.25329 19 9.5 19H19V0H9.5C4.25329 0 0 4.25329 0 9.5Z" fill="currentColor"/>
      <path d="M0 28.5C0 33.7467 4.25329 38 9.5 38H19V19H9.5C4.25329 19 0 23.2533 0 28.5Z" fill="currentColor"/>
    </svg>
  ),
  framer: () => (
    <svg className={styles.logo} viewBox="0 0 14 21" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 0H14V7H7L0 0ZM0 7H7L14 14H7V21L0 14V7Z" fill="currentColor"/>
    </svg>
  ),
  notion: () => (
    <svg className={styles.logo} viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M6.017 4.313l55.333 -4.087c6.797 -0.583 8.543 -0.19 12.817 2.917l17.663 12.443c2.913 2.14 3.883 2.723 3.883 5.053v68.243c0 4.277 -1.553 6.807 -6.99 7.193L24.467 99.967c-4.08 0.193 -6.023 -0.39 -8.16 -3.113L3.3 79.94c-2.333 -3.113 -3.3 -5.443 -3.3 -8.167V11.113c0 -3.497 1.553 -6.413 6.017 -6.8z" fill="currentColor"/>
      <path d="M61.35 0.227l-55.333 4.087C1.553 4.7 0 7.617 0 11.113v60.66c0 2.723 0.967 5.053 3.3 8.167l13.007 16.913c2.137 2.723 4.08 3.307 8.16 3.113l64.257 -3.89c5.433 -0.387 6.99 -2.917 6.99 -7.193V20.64c0 -2.21 -0.873 -2.847 -3.443 -4.733L74.167 3.143c-4.273 -3.107 -6.02 -3.5 -12.817 -2.917zM25.92 19.523c-5.247 0.353 -6.437 0.433 -9.417 -1.99L8.927 11.507c-0.77 -0.78 -0.383 -1.753 1.557 -1.947l53.193 -3.887c4.467 -0.39 6.793 1.167 8.54 2.527l9.123 6.61c0.39 0.197 1.36 1.36 0.193 1.36l-54.933 3.307 -0.68 0.047zM19.803 88.3V30.367c0 -2.53 0.777 -3.697 3.103 -3.893L86 22.78c2.14 -0.193 3.107 1.167 3.107 3.693v57.547c0 2.53 -0.39 4.67 -3.883 4.863l-60.377 3.5c-3.493 0.193 -5.043 -0.97 -5.043 -4.083zm59.6 -54.827c0.387 1.75 0 3.5 -1.75 3.7l-2.91 0.577v42.773c-2.527 1.36 -4.853 2.137 -6.797 2.137 -3.107 0 -3.883 -0.973 -6.21 -3.887l-19.03 -29.94v28.967l6.02 1.363s0 3.5 -4.857 3.5l-13.39 0.777c-0.39 -0.78 0 -2.723 1.357 -3.11l3.497 -0.97v-38.3L30.48 40.667c-0.39 -1.75 0.58 -4.277 3.3 -4.473l14.367 -0.967 19.8 30.327v-26.83l-5.047 -0.58c-0.39 -2.143 1.163 -3.7 3.103 -3.89l13.4 -0.78z" fill="var(--color-app-bg, #09090b)"/>
    </svg>
  ),
  linear: () => (
    <svg className={styles.logo} viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M1.22541 61.5228c-.2225-.9485.90748-1.5459 1.59638-.857L39.3342 97.1782c.6889.6889.0915 1.8189-.857 1.5765C20.0515 94.4522 5.54779 79.9485 1.22541 61.5228ZM.00189669 46.8891c-.01764375.2833.08887215.5599.29588351.7669l52.0571182 52.0571c.2071.2071.4837.3135.767.2959 6.4399-.4092 12.4378-2.1882 17.7014-5.0471-5.3232-6.7801-13.5887-11.6482-23.0306-12.7851-14.4688-1.7419-30.3256 5.3217-38.5917 19.2662 3.388-5.2042 7.9866-9.9201 13.6476-13.5737-11.3223-3.9722-21.3779-12.5701-24.5802-25.5387-1.02877 6.5756-.2556 13.4466 2.23809 19.7857-4.73303-4.5181-8.00658-10.4426-8.77635-16.8918-.0324-.2724-.05765-.5457-.07542-.8196l-.0007-.0155c-.01015-.1652-.01804-.331-.02371-.4972-.01335-.3897-.01879-.7811-.01641-1.174.03091-5.0963 1.08061-9.9698 2.9655-14.4338 6.52112 3.1008 12.2122 8.1009 16.0453 14.7586 3.8332 6.6578 5.5138 14.18 5.1653 21.4653 10.2253-12.0206 12.0368-30.4663 2.708-45.047C8.26428 27.8763 1.98172 38.6582.00189669 46.8891ZM80.2105 91.9996c-5.0969 3.0173-10.6992 5.0685-16.6227 5.9947.0004-.0015.0008-.003.0012-.0044.4524-1.637.7851-3.2915.9997-4.9497-2.0225 1.0235-4.1857 1.8109-6.4624 2.3147 2.7718-2.2153 5.1689-4.8591 7.0711-7.8546 1.8556-2.9222 3.1897-6.0866 3.9844-9.3743 3.6162 4.0743 6.0992 9.3296 6.8291 15.2143.0604.4679.1095.9373.1469 1.4084.0245.3082.0452.6175.0624.9282l-.0097.0227Z" fill="currentColor"/>
    </svg>
  ),
  vercel: () => (
    <svg className={styles.logo} viewBox="0 0 76 65" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M37.5274 0L75.0548 65H0L37.5274 0Z" fill="currentColor"/>
    </svg>
  ),
  stripe: () => (
    <svg className={styles.logo} viewBox="0 0 60 25" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path fillRule="evenodd" clipRule="evenodd" d="M59.64 12.92c0-4.28-2.07-7.66-6.04-7.66-3.98 0-6.4 3.38-6.4 7.63 0 5.04 2.85 7.58 6.93 7.58 1.99 0 3.5-.45 4.64-1.09v-3.35c-1.14.57-2.45.92-4.11.92-1.63 0-3.07-.57-3.25-2.55h8.19c0-.22.04-1.08.04-1.48zm-8.28-1.59c0-1.9 1.16-2.69 2.22-2.69 1.03 0 2.12.79 2.12 2.69h-4.34zM40.95 5.26c-1.64 0-2.69.77-3.28 1.31l-.22-1.04h-3.68v19.54l4.18-.89.01-4.74c.6.44 1.48 1.06 2.95 1.06 2.98 0 5.7-2.4 5.7-7.68-.01-4.83-2.77-7.56-5.66-7.56zm-1 11.63c-.98 0-1.56-.35-1.96-.79l-.02-6.24c.43-.49 1.03-.83 1.98-.83 1.52 0 2.56 1.7 2.56 3.92 0 2.26-1.03 3.94-2.56 3.94zM28.24 4.14l4.2-.9V0l-4.2.89v3.25zM28.24 5.53h4.2v14.74h-4.2V5.53zM23.6 6.72l-.26-1.19h-3.62v14.74h4.18V10.1c.99-1.29 2.66-1.05 3.18-.87V5.53c-.54-.2-2.5-.58-3.48 1.19zM15.67 1.73l-4.08.87-.02 13.5c0 2.49 1.87 4.33 4.37 4.33 1.38 0 2.39-.25 2.95-.56V16.5c-.54.22-3.2 1-3.2-1.49V8.98h3.2V5.53h-3.2l-.02-3.8zM4.43 9.79c0-.66.54-.91 1.44-.91 1.29 0 2.91.39 4.2 1.09V6.05c-1.4-.56-2.79-.78-4.2-.78C2.33 5.27 0 7.13 0 10.05c0 4.53 6.23 3.8 6.23 5.76 0 .78-.68 1.03-1.63 1.03-1.41 0-3.22-.58-4.65-1.36v3.96a11.8 11.8 0 0 0 4.65.96c3.59 0 6.06-1.78 6.06-4.74-.01-4.89-6.23-4.02-6.23-5.87z" fill="currentColor"/>
    </svg>
  ),
  github: () => (
    <svg className={styles.logo} viewBox="0 0 98 96" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path fillRule="evenodd" clipRule="evenodd" d="M48.854 0C21.839 0 0 22 0 49.217c0 21.756 13.993 40.172 33.405 46.69 2.427.49 3.316-1.059 3.316-2.362 0-1.141-.08-5.052-.08-9.127-13.59 2.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015 4.934.326 7.523 5.052 7.523 5.052 4.367 7.496 11.404 5.378 14.235 4.074.404-3.178 1.699-5.378 3.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283 0-5.378 1.94-9.778 5.014-13.2-.485-1.222-2.184-6.275.486-13.038 0 0 4.125-1.304 13.426 5.052a46.97 46.97 0 0 1 12.214-1.63c4.125 0 8.33.571 12.213 1.63 9.302-6.356 13.427-5.052 13.427-5.052 2.67 6.763.97 11.816.485 13.038 3.155 3.422 5.015 7.822 5.015 13.2 0 18.905-11.404 23.06-22.324 24.283 1.78 1.548 3.316 4.481 3.316 9.126 0 6.6-.08 11.897-.08 13.526 0 1.304.89 2.853 3.316 2.364 19.412-6.52 33.405-24.935 33.405-46.691C97.707 22 75.788 0 48.854 0z" fill="currentColor"/>
    </svg>
  ),
  slack: () => (
    <svg className={styles.logo} viewBox="0 0 54 54" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M19.712.133a5.381 5.381 0 0 0-5.376 5.387 5.381 5.381 0 0 0 5.376 5.386h5.376V5.52A5.381 5.381 0 0 0 19.712.133m0 14.365H5.376A5.381 5.381 0 0 0 0 19.884a5.381 5.381 0 0 0 5.376 5.387h14.336a5.381 5.381 0 0 0 5.376-5.387 5.381 5.381 0 0 0-5.376-5.386" fill="currentColor"/>
      <path d="M53.76 19.884a5.381 5.381 0 0 0-5.376-5.386 5.381 5.381 0 0 0-5.376 5.386v5.387h5.376a5.381 5.381 0 0 0 5.376-5.387m-14.336 0V5.52A5.381 5.381 0 0 0 34.048.133a5.381 5.381 0 0 0-5.376 5.387v14.364a5.381 5.381 0 0 0 5.376 5.387 5.381 5.381 0 0 0 5.376-5.387" fill="currentColor"/>
      <path d="M34.048 54a5.381 5.381 0 0 0 5.376-5.387 5.381 5.381 0 0 0-5.376-5.386h-5.376v5.386A5.381 5.381 0 0 0 34.048 54m0-14.365h14.336a5.381 5.381 0 0 0 5.376-5.386 5.381 5.381 0 0 0-5.376-5.387H34.048a5.381 5.381 0 0 0-5.376 5.387 5.381 5.381 0 0 0 5.376 5.386" fill="currentColor"/>
      <path d="M0 34.249a5.381 5.381 0 0 0 5.376 5.386 5.381 5.381 0 0 0 5.376-5.386v-5.387H5.376A5.381 5.381 0 0 0 0 34.25m14.336-.001v14.364A5.381 5.381 0 0 0 19.712 54a5.381 5.381 0 0 0 5.376-5.387V34.25a5.381 5.381 0 0 0-5.376-5.387 5.381 5.381 0 0 0-5.376 5.387" fill="currentColor"/>
    </svg>
  ),
};

const LogoMarquee = () => {
  const containerRef = useRef<HTMLDivElement>(null);

  const logoComponents = [
    { name: 'Figma', Logo: Logos.figma },
    { name: 'Framer', Logo: Logos.framer },
    { name: 'Notion', Logo: Logos.notion },
    { name: 'Linear', Logo: Logos.linear },
    { name: 'Vercel', Logo: Logos.vercel },
    { name: 'Stripe', Logo: Logos.stripe },
    { name: 'GitHub', Logo: Logos.github },
    { name: 'Slack', Logo: Logos.slack },
  ];

  useEffect(() => {
    const container = containerRef.current;
    if (!container) return;

    // Set initial state - visible
    gsap.set(container, { y: 0, opacity: 1 });

    // Create ScrollTrigger for hide/show
    const trigger = ScrollTrigger.create({
      start: 0,
      end: 100,
      onUpdate: (self) => {
        const scrollY = self.scroll();

        // Hide when scrolled past 10px (basically not at top)
        if (scrollY > 10) {
          gsap.to(container, {
            y: 100,
            opacity: 0,
            duration: 0.3,
            ease: 'power3.in',
            overwrite: true,
          });
        } else {
          gsap.to(container, {
            y: 0,
            opacity: 1,
            duration: 0.4,
            ease: 'power3.out',
            overwrite: true,
          });
        }
      },
    });

    return () => {
      trigger.kill();
    };
  }, []);

  return (
    <div ref={containerRef} className={styles.fixedContainer}>
      <Marquee speed={35} pauseOnHover={true}>
        {logoComponents.map(({ name, Logo }, index) => (
          <div key={index} className={styles.logoItem}>
            <Logo />
            <span className={styles.logoName}>{name}</span>
          </div>
        ))}
      </Marquee>
    </div>
  );
};

export default LogoMarquee;
